[2024-11-26 11:05:27][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 11:05:27][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 11:05:27][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 11:05:27][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 11:05:28][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 11:05:28][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 11:05:28][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 11:05:28][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 11:06:11][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 11:06:11][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 11:10:24][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 11:10:24][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 11:21:53][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 11:21:53][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 14:28:38][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 14:28:38][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1+cu124
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - CUDA 12.4 - cuDNN 90100
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 14:37:17][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 14:37:17][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 14:58:41][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 14:58:41][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 14:58:42][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 14:58:42][ganslate.engines.trainer][INFO] - Training started.
[2024-11-26 14:59:03][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 20.209, data: 1.184 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.244 D_B: 9.473 cycle_A: 1.873 G_BA: 3.008 D_A: 4.899 cycle_B: 3.402 
[2024-11-26 14:59:05][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-26 14:59:07][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-26 15:02:18][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.015 mse: 0.827 nmse: 1.150 psnr: -1.008 mae: 0.858 ssim_clean_mask: 0.491 mse_clean_mask: 0.480 nmse_clean_mask: 1.162 psnr_clean_mask: 4.912 mae_clean_mask: 0.626 cycle_SSIM: -0.010 
[2024-11-26 15:02:22][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 2 | comp: 1.490, data: 0.918 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.702 D_B: 13.812 cycle_A: 1.953 G_BA: 38.465 D_A: 62.963 cycle_B: 3.254 
[2024-11-26 15:02:23][ganslate.engines.trainer][INFO] - Saving the model after 2 iterations.
[2024-11-26 15:02:26][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-26 15:05:30][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 2) --------------------
ssim: 0.029 mse: 0.805 nmse: 1.120 psnr: -0.896 mae: 0.841 ssim_clean_mask: 0.506 mse_clean_mask: 0.480 nmse_clean_mask: 1.169 psnr_clean_mask: 4.942 mae_clean_mask: 0.621 cycle_SSIM: 0.017 
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-26 15:11:15][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-26 15:11:15][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 15:11:16][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-26 15:11:16][ganslate.engines.trainer][INFO] - Training started.
[2024-11-26 15:11:38][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 20.309, data: 1.215 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.777 D_B: 4.638 cycle_A: 2.081 G_BA: 2.382 D_A: 4.776 cycle_B: 3.199 
[2024-11-26 15:11:39][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-26 15:11:42][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-26 15:14:48][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.313 mse: 2832889.567 nmse: 3.976 psnr: 3.948 mae: 1577.323 ssim_clean_mask: 0.532 mse_clean_mask: 1588157.489 nmse_clean_mask: 4.285 psnr_clean_mask: 10.040 mae_clean_mask: 1116.134 cycle_SSIM: 0.013 
[2024-11-26 15:14:53][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 2 | comp: 1.502, data: 1.067 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 11.083 D_B: 29.937 cycle_A: 2.372 G_BA: 10.397 D_A: 19.325 cycle_B: 3.258 
[2024-11-26 15:14:54][ganslate.engines.trainer][INFO] - Saving the model after 2 iterations.
[2024-11-26 15:14:57][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-26 15:18:01][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 2) --------------------
ssim: -0.394 mse: 2969221.983 nmse: 4.168 psnr: 3.743 mae: 1604.308 ssim_clean_mask: 0.526 mse_clean_mask: 1634298.157 nmse_clean_mask: 4.413 psnr_clean_mask: 9.912 mae_clean_mask: 1111.541 cycle_SSIM: 0.024 
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 09:29:37][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 09:29:37][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 08:31:07][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 08:31:07][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 08:31:08][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 08:31:08][ganslate.engines.trainer][INFO] - Training started.
[2024-11-28 08:31:36][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 26.436, data: 1.337 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.165 D_B: 7.047 cycle_A: 2.282 G_BA: 4.885 D_A: 7.123 cycle_B: 3.087 
[2024-11-28 08:31:38][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-28 08:31:41][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 08:34:59][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.308 mse: 3209637.300 nmse: 4.504 psnr: 3.407 mae: 1665.629 ssim_clean_mask: 0.539 mse_clean_mask: 1798093.883 nmse_clean_mask: 4.831 psnr_clean_mask: 9.527 mae_clean_mask: 1168.909 cycle_SSIM: 0.011 
[2024-11-28 08:35:03][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 2 | comp: 1.504, data: 0.677 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 11.647 D_B: 35.718 cycle_A: 2.225 G_BA: 5.863 D_A: 15.834 cycle_B: 2.860 
[2024-11-28 08:35:04][ganslate.engines.trainer][INFO] - Saving the model after 2 iterations.
[2024-11-28 08:35:07][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 08:38:17][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 2) --------------------
ssim: -0.344 mse: 3411026.167 nmse: 4.789 psnr: 3.141 mae: 1699.235 ssim_clean_mask: 0.542 mse_clean_mask: 1851114.954 nmse_clean_mask: 4.981 psnr_clean_mask: 9.389 mae_clean_mask: 1156.826 cycle_SSIM: 0.018 
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 2
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 08:42:58][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 08:42:58][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 08:42:59][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 08:42:59][ganslate.engines.trainer][INFO] - Training started.
[2024-11-28 08:43:21][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 20.523, data: 1.333 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.437 D_B: 8.984 cycle_A: 2.316 G_BA: 5.303 D_A: 8.936 cycle_B: 3.180 
[2024-11-28 08:43:22][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-28 08:43:25][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 08:46:41][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.359 mse: 11147964614792.533 nmse: 3.869 psnr: 4.071 mae: 3168618.800 ssim_clean_mask: 0.514 mse_clean_mask: 6724274812552.816 nmse_clean_mask: 4.518 psnr_clean_mask: 9.818 mae_clean_mask: 2361481.397 cycle_SSIM: 0.012 
[2024-11-28 08:46:45][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 2 | comp: 1.513, data: 0.910 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 4.795 D_B: 10.929 cycle_A: 2.330 G_BA: 3.511 D_A: 10.508 cycle_B: 3.486 
[2024-11-28 08:46:46][ganslate.engines.trainer][INFO] - Saving the model after 2 iterations.
[2024-11-28 08:46:49][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 08:50:00][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 2) --------------------
ssim: -0.339 mse: 10882116485120.000 nmse: 3.776 psnr: 4.176 mae: 3143737.967 ssim_clean_mask: 0.505 mse_clean_mask: 6973654703232.406 nmse_clean_mask: 4.694 psnr_clean_mask: 9.655 mae_clean_mask: 2424408.649 cycle_SSIM: 0.018 
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 09:06:33][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 09:06:33][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:06:34][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:06:34][ganslate.engines.trainer][INFO] - Training started.
[2024-11-28 09:06:56][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 20.362, data: 1.196 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.006 D_B: 8.199 cycle_A: 1.837 G_BA: 4.794 D_A: 7.536 cycle_B: 3.100 
[2024-11-28 09:06:57][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-28 09:07:00][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 09:10:12][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.300 mse: 12111156958549.334 nmse: 4.201 psnr: 3.713 mae: 3266064.083 ssim_clean_mask: 0.539 mse_clean_mask: 6664731075035.105 nmse_clean_mask: 4.454 psnr_clean_mask: 9.875 mae_clean_mask: 2297105.814 cycle_SSIM: -0.021 
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 09:23:10][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 09:23:10][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:23:10][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:23:11][ganslate.engines.trainer][INFO] - Training started.
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - Global rank: 0
[2024-11-28 09:24:25][ganslate.utils.environment][INFO] - Local rank: 0
[2024-11-28 09:24:26][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:24:26][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-11-28 09:24:27][ganslate.engines.trainer][INFO] - Training started.
[2024-11-28 09:24:50][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 21.111, data: 1.889 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.590 D_B: 8.124 cycle_A: 2.121 G_BA: 3.661 D_A: 4.862 cycle_B: 3.850 
[2024-11-28 09:24:51][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-11-28 09:24:53][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-11-28 09:28:05][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.320 mse: 3097283.117 nmse: 4.349 psnr: 3.559 mae: 1643.339 ssim_clean_mask: 0.534 mse_clean_mask: 1664708.617 nmse_clean_mask: 4.499 psnr_clean_mask: 9.829 mae_clean_mask: 1132.312 cycle_SSIM: 0.019 
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 19:25:29][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 19:25:29][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 19:36:00][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 19:36:00][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 19:36:01][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 19:36:02][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 19:36:26][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.949, data: 0.981 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.536 D_B: 4.361 cycle_A: 1.084 G_BA: 3.115 D_A: 5.982 cycle_B: 3.428 
[2024-12-14 19:36:27][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 19:36:30][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 19:40:11][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 19:40:11][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 19:40:11][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 19:40:11][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 19:40:12][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 19:40:12][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 19:40:12][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 19:40:12][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 19:40:12][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 19:40:13][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 19:40:37][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.872, data: 1.056 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 3.165 D_B: 4.842 cycle_A: 1.707 G_BA: 3.304 D_A: 6.389 cycle_B: 2.819 
[2024-12-14 19:40:39][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 19:40:41][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 19:47:49][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.509 mse: 3621154.133 nmse: 4.167 psnr: 2.876 mae: 1833.434 ssim_clean_mask: 0.751 mse_clean_mask: 1694802.947 nmse_clean_mask: 4.581 psnr_clean_mask: 12.492 mae_clean_mask: 1133.145 cycle_SSIM: 0.071 
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 19:57:46][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 19:57:46][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:02:27][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:02:27][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [2024-12-14 20:28:55][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:28:55][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:28:55][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:29:14][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:29:14][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:29:39][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:29:39][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:29:39][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:29:40][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:30:04][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.588, data: 1.190 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 3.300 D_B: 6.075 cycle_A: 1.148 G_BA: 3.869 D_A: 6.801 cycle_B: 3.407 
[2024-12-14 20:30:06][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:30:08][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:33:06][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:33:06][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:33:07][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:33:08][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:33:32][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.730, data: 1.058 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.759 D_B: 4.960 cycle_A: 1.263 G_BA: 6.830 D_A: 11.108 cycle_B: 2.845 
[2024-12-14 20:33:34][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:33:36][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:35:49][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:35:49][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:35:50][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:35:51][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:36:15][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 23.261, data: 1.318 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 1.891 D_B: 4.501 cycle_A: 1.634 G_BA: 3.199 D_A: 5.487 cycle_B: 3.190 
[2024-12-14 20:36:17][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:36:20][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:46:38][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:46:38][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:51:21][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:51:21][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:51:21][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:51:21][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:51:22][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:51:22][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:51:22][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:51:22][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:51:22][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:51:23][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:51:47][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.648, data: 1.229 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.711 D_B: 10.020 cycle_A: 1.268 G_BA: 3.975 D_A: 6.359 cycle_B: 2.918 
[2024-12-14 20:51:49][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:51:51][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:54:49][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:54:49][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:54:50][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:54:51][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:55:14][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.820, data: 1.010 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 3.098 D_B: 4.892 cycle_A: 1.634 G_BA: 3.997 D_A: 6.601 cycle_B: 3.070 
[2024-12-14 20:55:16][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:55:19][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 20:57:20][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 20:57:20][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:57:20][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 20:57:21][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 20:57:45][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.875, data: 1.206 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 4.178 D_B: 6.262 cycle_A: 1.332 G_BA: 5.710 D_A: 9.581 cycle_B: 2.661 
[2024-12-14 20:57:47][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 20:57:50][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 21:07:48][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 21:07:48][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:07:49][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:07:49][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 21:08:13][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.878, data: 1.016 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 6.444 D_B: 11.096 cycle_A: 1.069 G_BA: 3.262 D_A: 5.422 cycle_B: 3.031 
[2024-12-14 21:08:15][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 21:08:18][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 21:09:01][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 21:09:01][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:09:01][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:09:02][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 21:09:26][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.872, data: 1.362 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.957 D_B: 6.409 cycle_A: 1.557 G_BA: 2.969 D_A: 5.480 cycle_B: 2.782 
[2024-12-14 21:09:28][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 21:09:32][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 21:16:37][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.533 mse: 3344637.517 nmse: 3.849 psnr: 3.221 mae: 1785.590 ssim_clean_mask: 0.739 mse_clean_mask: 2162931.660 nmse_clean_mask: 5.916 psnr_clean_mask: 11.398 mae_clean_mask: 1349.052 cycle_SSIM: 0.237 
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 21:23:53][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 21:23:53][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:23:54][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 21:23:54][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 21:24:18][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.927, data: 1.233 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 2.558 D_B: 5.554 cycle_A: 1.455 G_BA: 2.443 D_A: 5.285 cycle_B: 2.760 
[2024-12-14 21:24:20][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 21:24:23][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 21:31:23][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.338 mse: 3570744.750 nmse: 4.110 psnr: 2.936 mae: 1831.973 ssim_clean_mask: 0.753 mse_clean_mask: 1998909.291 nmse_clean_mask: 5.441 psnr_clean_mask: 11.753 mae_clean_mask: 1263.541 cycle_SSIM: 0.160 
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 22:41:42][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 22:41:42][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 22:41:58][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 22:41:58][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 22:42:23][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 22:42:23][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:42:23][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:42:24][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 22:42:48][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.562, data: 1.341 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.337 D_B: 8.659 cycle_A: 0.618 G_BA: 1.901 D_A: 5.027 cycle_B: 3.712 
[2024-12-14 22:42:50][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 22:42:52][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 22:49:38][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.619 mse: 3191319.800 nmse: 3.672 psnr: 3.425 mae: 1736.875 ssim_clean_mask: 0.742 mse_clean_mask: 1717424.606 nmse_clean_mask: 4.671 psnr_clean_mask: 12.412 mae_clean_mask: 1187.776 cycle_SSIM: 0.347 
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - Configuration:
project: ./mri_to_ct/
mode: train
train:
  output_dir: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
  batch_size: 1
  cuda: true
  mixed_precision: false
  opt_level: O1
  logging:
    freq: 1
    multi_modality_split: null
    tensorboard: true
    wandb: null
    image_window: null
  dataset:
    _target_: project.datasets.train_dataset.SynthRAD2023TrainDataset
    root: /mnt/homeGPU/tenayat/data/TRAIN
    num_workers: 0
    pin_memory: true
    patch_size:
    - 32
    - 160
    - 160
    focal_region_proportion: 0.0
    augmentation: false
    unpaired: true
  checkpointing:
    load_iter: null
    freq: 1
    start_after: 0
    load_optimizers: true
  n_iters: 1
  n_iters_decay: 0
  gan:
    _target_: ganslate.nn.gans.unpaired.CycleGAN
    norm_type: instance
    weight_init_type: normal
    weight_init_gain: 0.02
    optimizer:
      adversarial_loss_type: lsgan
      beta1: 0.5
      beta2: 0.999
      lr_D: 0.0002
      lr_G: 0.0004
      lambda_AB: 5.0
      lambda_BA: 5.0
      lambda_identity: 0.0
      proportion_ssim: 0.0
    generator:
      _target_: ganslate.nn.generators.Vnet3D
      in_out_channels:
        AB:
        - 1
        - 1
        BA: ${train.gan.generator.in_out_channels.AB}
      use_memory_saving: false
      use_inverse: false
      first_layer_channels: 16
      down_blocks:
      - 2
      - 2
      - 3
      up_blocks:
      - 3
      - 3
      - 3
      is_separable: false
    discriminator:
      _target_: ganslate.nn.discriminators.PatchGAN3D
      in_channels:
        B: 1
        A: ${train.gan.discriminator.in_channels.B}
      ndf: 64
      n_layers: 2
      kernel_size:
      - 4
      - 4
      - 4
    pool_size: 50
  seed: null
  metrics:
    discriminator_evolution: true
    ssim: false
val:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/VAL
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  freq: ${train.checkpointing.freq}
  start_after: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    cycle_metrics: true
    save_to_csv: true
test:
  output_dir: ${train.output_dir}
  batch_size: ${train.batch_size}
  cuda: ${train.cuda}
  mixed_precision: ${train.mixed_precision}
  opt_level: ${train.opt_level}
  logging: ${train.logging}
  dataset:
    _target_: project.datasets.val_test_dataset.SynthRAD2023ValTestDataset
    root: /mnt/homeGPU/tenayat/data/TEST
    num_workers: 0
    pin_memory: true
  sliding_window:
    window_size: ${train.dataset.patch_size}
    batch_size: 1
    overlap: 0.25
    mode: gaussian
  multi_dataset: null
  checkpointing:
    load_iter: 0
  metrics:
    ssim: true
    psnr: true
    nmse: true
    mse: true
    mae: true
    nmi: false
    histogram_chi2: false
    compute_over_input: false
    save_to_csv: true
infer: null

[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - Saving checkpoints, logs and config to: /mnt/homeGPU/tenayat/mri_to_ct/cyclegan_temp
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - Python version: 3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - PyTorch version: 2.5.1
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - CUDA 11.8 - cuDNN 90100
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - Global rank: 0
[2024-12-14 22:59:02][ganslate.utils.environment][INFO] - Local rank: 0
[2024-12-14 22:59:02][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:59:03][ganslate.nn.generators.vnet.vnet3d][INFO] - Invertible layers are disabled.
[2024-12-14 22:59:03][ganslate.engines.trainer][INFO] - Training started.
[2024-12-14 22:59:27][ganslate.utils.trackers.training][INFO] - 
-------------------- (iter: 1 | comp: 22.692, data: 1.193 | lr_G: 0.0004000, lr_D: 0.0002000) --------------------
G_AB: 5.140 D_B: 6.744 cycle_A: 1.728 G_BA: 3.543 D_A: 6.195 cycle_B: 3.191 
[2024-12-14 22:59:29][ganslate.engines.trainer][INFO] - Saving the model after 1 iterations.
[2024-12-14 22:59:32][ganslate.engines.validator_tester][INFO] - Validation started.
[2024-12-14 23:06:34][ganslate.utils.trackers.validation_testing][INFO] - 
-------------------- (Val at iter 1) --------------------
ssim: -0.521 mse: 3629168.667 nmse: 4.176 psnr: 2.866 mae: 1872.053 ssim_clean_mask: 0.737 mse_clean_mask: 2939357.796 nmse_clean_mask: 8.085 psnr_clean_mask: 10.059 mae_clean_mask: 1611.936 cycle_SSIM: 0.199 
